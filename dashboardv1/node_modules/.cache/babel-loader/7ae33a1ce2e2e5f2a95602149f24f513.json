{"ast":null,"code":"var _jsxFileName = \"/home/danielo/Development/ui/dashboardV1/src/Mint.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useContext, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport MOLCOMMONS_ABI from './MOLCOMMONS_ABI';\nimport { ethers } from 'ethers';\nimport axios from 'axios';\nimport moralis from \"moralis\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nmoralis.initialize(process.env.REACT_APP_MORALIS_APPLICATION_ID);\nmoralis.serverURL = process.env.REACT_APP_MORALIS_SERVER_URL;\n\nconst Mint = ({\n  metadata,\n  sale,\n  ethPrice,\n  coinPrice,\n  img\n}) => {\n  _s();\n\n  // ----- useContext\n  const [imageHash, setImageHash] = useState('');\n  const [imageUrl, setImageUrl] = useState('profile.jpg');\n  const [commonsAddress, setCommonsAddress] = useState(''); // ----- Reaect Router Config\n\n  const history = useHistory();\n  const Commons = moralis.Object.extend(\"Commons\", {// Instance methods\n  }, {\n    newCommons: function () {\n      const commons = new Commons();\n      commons.set(\"name\", document.getElementById('commonsname').value);\n      commons.set(\"vaultsymbol\", document.getElementById('vaultsymbol').value);\n      commons.set(\"organizer\", document.getElementById('organizer0').value);\n      commons.set(\"vaultname\", document.getElementById('vaultname').value);\n      commons.set(\"confirmations\", document.getElementById('confirmations').value);\n      alert('tfer ' + document.getElementById('transferrable').checked + '');\n      commons.set(\"transferrable\", document.getElementById('transferrable').checked + '');\n      var radios = document.getElementsByName('radio-group');\n\n      for (var i = 0; i < radios.length; i++) {\n        if (radios[i].checked) {\n          commons.set(\"use\", radios[i].value); //        alert( 'elements ' + i + ' ' + radios[i].checked );\n        }\n      }\n\n      return commons;\n    }\n  });\n\n  const getCommons = async () => {\n    var commonsId = window.location.search.substring(11);\n    const query = new moralis.Query(Commons);\n    query.equalTo(\"objectId\", commonsId);\n    const results = await query.find();\n    var commonsObject;\n\n    for (let i = 0; i < results.length; i++) // wtf??? only expecting one result. gotta find acceptable solution for this\n    {\n      const object = results[i];\n      commonsObject = object;\n      setCommonsAddress(object.get('contractaddress'));\n      alert('commons ' + object.get('contractaddress'));\n    }\n  }; // ----- Smart Contract Config\n\n\n  const provider = new ethers.providers.Web3Provider(window.ethereum, 'any');\n  const signer = provider.getSigner(); // ----- Upload image to Fleek Storage\n\n  const upload = async () => {\n    await getCommons();\n    const url = `https://api.pinata.cloud/pinning/pinFileToIPFS`;\n    let data = new FormData();\n    data.append(\"file\", img, img.name);\n    const res = await axios.post(url, data, {\n      maxContentLength: \"Infinity\",\n      headers: {\n        \"Content-Type\": `multipart/form-data; boundary=${data._boundary}`,\n        pinata_api_key: process.env.REACT_APP_PINATA_PUBLIC,\n        pinata_secret_api_key: process.env.REACT_APP_PINATA_PRIVATE\n      }\n    });\n    console.log(res.data);\n    setImageHash(res.data.IpfsHash);\n    setImageUrl('https://gateway.pinata.cloud/ipfs/' + res.data.IpfsHash);\n    /*  const input = {\n        apiKey: process.env.REACT_APP_FLEEK_API_KEY,\n        apiSecret: process.env.REACT_APP_FLEEK_API_SECRET,\n        bucket: 'audsssy-team-bucket',\n        key: metadata.title,\n        data,\n      }*/\n\n    try {\n      //const result = await fleek.upload(input)\n      //console.log('this is image hash from fleek - ' + result.hash)\n      // Prepare to mint NFT\n      uploadAndMint(res.data.IpfsHash);\n    } catch (e) {\n      console.log('error is - ' + e);\n    }\n  }; // ----- Upload tokenURI and Mint NFT\n\n\n  const uploadAndMint = async hash => {\n    await getCommons();\n    const baseUrl = 'https://ipfs.io/ipfs/'; // Add timestamp to metadata\n\n    const date = new Date();\n    const timestamp = date.getTime();\n    const dict = { ...metadata,\n      image: baseUrl + hash,\n      createdAt: timestamp\n    };\n    console.log('tokenURI at mint is - ', dict);\n    alert('tokenURI at mint is - ', dict);\n    /*  const data = JSON.stringify(dict)\n      const i = {\n        apiKey: process.env.REACT_APP_FLEEK_API_KEY,\n        apiSecret: process.env.REACT_APP_FLEEK_API_SECRET,\n        bucket: 'audsssy-team-bucket',\n        key: hash,\n        data,\n      }\n    */\n\n    try {\n      // Uplaod tokenUri to Fleek\n      //    const result = await fleek.upload(i)\n      //    console.log('this is tokenUri hash from fleek - ' + result.hash)\n      // Mint NFT\n      const tokenUri = baseUrl + hash;\n      console.log(tokenUri);\n      const p = ethers.utils.parseEther(ethPrice);\n      const c = ethers.utils.parseEther(coinPrice);\n      molCommons(p, c, tokenUri);\n    } catch (e) {\n      console.log('error is - ' + e);\n    }\n  }; // ----- Mint Gamma with MolVault\n\n\n  const molCommons = async (price, coins, tokenURI) => {\n    console.log('MolVault contract is - ', commonsAddress);\n\n    const _contract = new ethers.Contract(commonsAddress, MOLCOMMONS_ABI, signer);\n\n    try {\n      const tx = await _contract.mint(price, coins, tokenURI, sale);\n      console.log('tx.hash for minting - ' + tx.hash);\n      tx.wait().then(receipt => {\n        if (receipt.confirmations === 1) {\n          console.log('mint receipt is - ', receipt);\n          history.push(`/community`); // Store user address to Firestore\n\n          addMinterToCoinHolders();\n        }\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  }; // ----- Listen to contract events\n  // function contractListener(contract) {\n  //   contract.on('Transfer', (from, to, tokenId) => {\n  //     console.log('Token minted - ', from, to)\n  //     console.log('NFT tokenId minted - ' + tokenId)\n  //   })\n  //   contract.on('gRoyaltiesMinted', (contractAddress) => {\n  //     console.log('gRoyalties minted at contract address  - ', contractAddress)\n  //   })\n  // }\n  // Add minter to Firestore\n\n\n  const addMinterToCoinHolders = async () => {\n    console.log(commonsAddress); // const docRef = projectFirestore.collection('vault').doc(commons)   \n\n    /*   signer.getAddress().then(address => {\n         console.log(address)\n          docRef.update({\n            holders: firebaseFieldValue.arrayUnion(address),\n          }) \n       })*/\n  };\n\n  useEffect(() => {\n    upload(img); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 200,\n    columnNumber: 10\n  }, this);\n};\n\n_s(Mint, \"6Q/FGScu+jmJuY3+3Z1xmkLSdis=\", false, function () {\n  return [useHistory];\n});\n\n_c = Mint;\nexport default Mint;\n\nvar _c;\n\n$RefreshReg$(_c, \"Mint\");","map":{"version":3,"sources":["/home/danielo/Development/ui/dashboardV1/src/Mint.js"],"names":["React","useEffect","useContext","useState","useHistory","MOLCOMMONS_ABI","ethers","axios","moralis","initialize","process","env","REACT_APP_MORALIS_APPLICATION_ID","serverURL","REACT_APP_MORALIS_SERVER_URL","Mint","metadata","sale","ethPrice","coinPrice","img","imageHash","setImageHash","imageUrl","setImageUrl","commonsAddress","setCommonsAddress","history","Commons","Object","extend","newCommons","commons","set","document","getElementById","value","alert","checked","radios","getElementsByName","i","length","getCommons","commonsId","window","location","search","substring","query","Query","equalTo","results","find","commonsObject","object","get","provider","providers","Web3Provider","ethereum","signer","getSigner","upload","url","data","FormData","append","name","res","post","maxContentLength","headers","_boundary","pinata_api_key","REACT_APP_PINATA_PUBLIC","pinata_secret_api_key","REACT_APP_PINATA_PRIVATE","console","log","IpfsHash","uploadAndMint","e","hash","baseUrl","date","Date","timestamp","getTime","dict","image","createdAt","tokenUri","p","utils","parseEther","c","molCommons","price","coins","tokenURI","_contract","Contract","tx","mint","wait","then","receipt","confirmations","push","addMinterToCoinHolders"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext, useState } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport MOLCOMMONS_ABI from './MOLCOMMONS_ABI'\nimport { ethers } from 'ethers'\n\nimport axios from 'axios';\nimport moralis from \"moralis\";\n\n\nmoralis.initialize(process.env.REACT_APP_MORALIS_APPLICATION_ID);\nmoralis.serverURL = process.env.REACT_APP_MORALIS_SERVER_URL;\n\n\nconst Mint = ({ metadata, sale, ethPrice, coinPrice, img }) => {\n  // ----- useContext\n\n  const [imageHash, setImageHash] = useState('');\n  const [imageUrl, setImageUrl] = useState('profile.jpg');\n  const [commonsAddress, setCommonsAddress] = useState(''); \n\n  // ----- Reaect Router Config\n  const history = useHistory()\n\n\n\nconst Commons = moralis.Object.extend( \"Commons\", \n        {\n          // Instance methods\n\n        }, \n        {  \n            newCommons: function() { \n                                        const commons = new Commons();\n                                        commons.set( \"name\",            document.getElementById( 'commonsname'     ).value  );\n                                        commons.set( \"vaultsymbol\",     document.getElementById( 'vaultsymbol'     ).value  );\n                                        commons.set( \"organizer\",       document.getElementById( 'organizer0'       ).value  ); \n                                        commons.set( \"vaultname\",       document.getElementById( 'vaultname'       ).value  ); \n                                        commons.set( \"confirmations\",   document.getElementById( 'confirmations'   ).value  );\n                                        alert( 'tfer ' + document.getElementById( 'transferrable'   ).checked + '' );\n                                        commons.set( \"transferrable\",   document.getElementById( 'transferrable'   ).checked + '' );\n                                       \n                                        var radios = document.getElementsByName( 'radio-group'   );                                 \n                                        for (var i = 0; i < radios.length; i++) \n                                        {\n                                            if ( radios[i].checked )\n                                            {\n                                               commons.set( \"use\",     radios[i].value  );\n                                       //        alert( 'elements ' + i + ' ' + radios[i].checked );\n                                            }\n                                        }\n                                        return commons; \n                                    }\n        });\n\n  const getCommons = async () =>\n                                        {\n                                            var commonsId =    window.location.search.substring( 11 );\n                                            const query = new moralis.Query( Commons );\n                                            query.equalTo( \"objectId\", commonsId );\n                                            const results = await query.find();\n                                            var commonsObject;\n                                            for ( let i = 0; i < results.length; i++ ) // wtf??? only expecting one result. gotta find acceptable solution for this\n                                            { \n                                                const object = results[i];\n                                                commonsObject = object;\n                                                setCommonsAddress( object.get('contractaddress') );\n                                                alert( 'commons '  + object.get('contractaddress') );\n                                            }\n                                        }\n\n\n  // ----- Smart Contract Config\n  const provider = new ethers.providers.Web3Provider(window.ethereum, 'any')\n  const signer = provider.getSigner()\n\n  // ----- Upload image to Fleek Storage\n  const upload = async () => {\nawait getCommons();\n    const url = `https://api.pinata.cloud/pinning/pinFileToIPFS`;\n    let   data = new FormData();\n    data.append(\"file\", img, img.name );\n    const res = await axios.post( url, data, {  maxContentLength: \"Infinity\", \n                                                headers: { \"Content-Type\": `multipart/form-data; boundary=${data._boundary}`,\n                                                            pinata_api_key: process.env.REACT_APP_PINATA_PUBLIC,\n                                                            pinata_secret_api_key: process.env.REACT_APP_PINATA_PRIVATE,            },\n                                              });\n    console.log(res.data);\n    setImageHash( res.data.IpfsHash );\n    setImageUrl( 'https://gateway.pinata.cloud/ipfs/' + res.data.IpfsHash );\n\n\n  /*  const input = {\n      apiKey: process.env.REACT_APP_FLEEK_API_KEY,\n      apiSecret: process.env.REACT_APP_FLEEK_API_SECRET,\n      bucket: 'audsssy-team-bucket',\n      key: metadata.title,\n      data,\n    }*/\n\n    try {\n      //const result = await fleek.upload(input)\n      //console.log('this is image hash from fleek - ' + result.hash)\n      // Prepare to mint NFT\n\n            uploadAndMint(res.data.IpfsHash)\n        } \n        catch (e) { console.log('error is - ' + e) }\n  }\n\n  // ----- Upload tokenURI and Mint NFT\n  const uploadAndMint = async (hash) => {\n    await getCommons();\n    const baseUrl = 'https://ipfs.io/ipfs/'\n\n    // Add timestamp to metadata\n    const date = new Date()\n    const timestamp = date.getTime()\n    const dict = { ...metadata, image: baseUrl + hash, createdAt: timestamp }\n    console.log('tokenURI at mint is - ', dict)\n    alert('tokenURI at mint is - ', dict)\n\n  /*  const data = JSON.stringify(dict)\n    const i = {\n      apiKey: process.env.REACT_APP_FLEEK_API_KEY,\n      apiSecret: process.env.REACT_APP_FLEEK_API_SECRET,\n      bucket: 'audsssy-team-bucket',\n      key: hash,\n      data,\n    }\n*/\n    try {\n      // Uplaod tokenUri to Fleek\n  //    const result = await fleek.upload(i)\n  //    console.log('this is tokenUri hash from fleek - ' + result.hash)\n\n      // Mint NFT\n      const tokenUri = baseUrl + hash\n      console.log(tokenUri)\n      const p = ethers.utils.parseEther(ethPrice)\n      const c = ethers.utils.parseEther(coinPrice)\n      molCommons(p, c, tokenUri)\n  \n    } catch (e) {\n      console.log('error is - ' + e )\n    }\n  }\n\n  // ----- Mint Gamma with MolVault\n  const molCommons = async (price, coins, tokenURI) => {\n    console.log('MolVault contract is - ', commonsAddress)\n    const _contract = new ethers.Contract(commonsAddress, MOLCOMMONS_ABI, signer)\n    try {\n      const tx = await _contract.mint(price, coins, tokenURI, sale)\n      console.log('tx.hash for minting - ' + tx.hash)\n\n      tx.wait().then((receipt) => {\n        if (receipt.confirmations === 1) {\n          console.log('mint receipt is - ', receipt)\n          history.push(`/community`)\n\n          // Store user address to Firestore\n          addMinterToCoinHolders()\n        }\n      })\n    } catch (e) {\n      console.log(e)\n    }\n  }\n\n  // ----- Listen to contract events\n  // function contractListener(contract) {\n  //   contract.on('Transfer', (from, to, tokenId) => {\n  //     console.log('Token minted - ', from, to)\n  //     console.log('NFT tokenId minted - ' + tokenId)\n  //   })\n\n  //   contract.on('gRoyaltiesMinted', (contractAddress) => {\n  //     console.log('gRoyalties minted at contract address  - ', contractAddress)\n  //   })\n  // }\n\n  // Add minter to Firestore\n  const addMinterToCoinHolders = async () => {\n    console.log(commonsAddress)\n   // const docRef = projectFirestore.collection('vault').doc(commons)   \n    \n /*   signer.getAddress().then(address => {\n      console.log(address)\n       docRef.update({\n         holders: firebaseFieldValue.arrayUnion(address),\n       }) \n    })*/\n  }\n\n  useEffect(() => {\n    upload(img)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  return <div></div>\n}\n\nexport default Mint\n"]},"metadata":{},"sourceType":"module"}